#!/bin/bash

echo "üéØ POST-SETUP INSTRUCTIONS: After Creating New App Service"
echo "=========================================================="
echo ""

echo "üìù AFTER YOU CREATE THE NEW APP SERVICE, DO THESE STEPS:"
echo ""

echo "1Ô∏è‚É£ GET THE NEW APP SERVICE SECRETS"
echo "=================================="
echo "‚Ä¢ In Azure Portal, go to your new app: campuspe-web-staging-new"
echo "‚Ä¢ Go to: Deployment Center ‚Üí GitHub Actions"
echo "‚Ä¢ Azure will show you the secrets that need to be added to GitHub"
echo "‚Ä¢ Copy these 3 secret values:"
echo "  - Client ID"
echo "  - Tenant ID" 
echo "  - Subscription ID"
echo ""

echo "2Ô∏è‚É£ ADD SECRETS TO GITHUB"
echo "========================"
echo "‚Ä¢ Go to: https://github.com/CampusPe/Campuspe_Staging/settings/secrets/actions"
echo "‚Ä¢ Click: New repository secret"
echo "‚Ä¢ Add these 3 secrets with the values from Azure:"
echo ""
echo "Secret Name: AZUREAPPSERVICE_CLIENTID_NEW_WEB"
echo "Secret Name: AZUREAPPSERVICE_TENANTID_NEW_WEB"
echo "Secret Name: AZUREAPPSERVICE_SUBSCRIPTIONID_NEW_WEB"
echo ""

echo "3Ô∏è‚É£ REMOVE OLD WORKFLOW FILE"
echo "============================"
echo "‚Ä¢ Delete the old workflow file:"
echo "‚Ä¢ File to delete: .github/workflows/main_campuspe-web-staging.yml"
echo ""

echo "4Ô∏è‚É£ PUSH CHANGES TO TRIGGER DEPLOYMENT"
echo "====================================="
echo "‚Ä¢ The new workflow is ready: .github/workflows/main_campuspe-web-staging-new.yml"
echo "‚Ä¢ API CORS is updated to allow new domain"
echo "‚Ä¢ Commit and push all changes"
echo ""

echo "5Ô∏è‚É£ TEST THE NEW DEPLOYMENT"
echo "=========================="
echo "‚Ä¢ Check GitHub Actions: https://github.com/CampusPe/Campuspe_Staging/actions"
echo "‚Ä¢ New app URL: https://campuspe-web-staging-new.azurewebsites.net"
echo "‚Ä¢ API should work with new frontend"
echo ""

echo "üö® IMPORTANT NOTES:"
echo "=================="
echo "‚Ä¢ Make sure to set all environment variables in the new app service"
echo "‚Ä¢ The startup command should be: node startup.js"
echo "‚Ä¢ Runtime stack: Node 20 LTS"
echo "‚Ä¢ The new app will have a clean GitHub Actions setup from the start"
echo ""

echo "‚úÖ VERIFICATION CHECKLIST:"
echo "========================="
echo "‚ñ° New app service created with name: campuspe-web-staging-new"
echo "‚ñ° GitHub Actions configured in Azure Deployment Center"
echo "‚ñ° 3 secrets added to GitHub repository"
echo "‚ñ° Environment variables set in Azure app configuration"
echo "‚ñ° Old workflow file deleted"
echo "‚ñ° Changes committed and pushed"
echo "‚ñ° GitHub Actions workflow running successfully"
echo "‚ñ° New app URL accessible and working"
